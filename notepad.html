<html>
<head>
<title id='title'>HTML5 Notepad</title>
<link rel="icon" type="image/gif" href="/notepad-icon.gif" />
<script>

function checkTime(i) {
  if (i<10) {i = "0" + i};  // add zero in front of numbers < 10
  return i;
}

function saveDoc() {
  console.log("attempting to save document...") ;
  var d = new Date() ;
  var monthArray = new Array();
  monthArray[0] = "Jan"; monthArray[1] = "Feb"; monthArray[2] = "Mar"; monthArray[3] = "Apr";
  monthArray[4] = "May"; monthArray[5] = "Jun"; monthArray[6] = "Jul"; monthArray[7] = "Aug";
  monthArray[8] = "Sep"; monthArray[9] = "Oct"; monthArray[10] = "Nov"; monthArray[11] = "Dec";
  var month = monthArray[d.getMonth()];
  var date = d.getDate() ;
  var hour = d.getHours() ;
  var timePeriod = "am" ;
  if (hour >= 12) {
    hour -= 12 ;
    timePeriod = "pm" ;
  }
  var minute = d.getMinutes() ;
  minute = checkTime(minute) ;
  localStorage.notepadSaveString = month+" "+date+", "+hour+":"+minute+" "+timePeriod ;
  localStorage.notepadContent = myTextarea.value ;
  document.getElementById('title').innerHTML = "Saved: " + localStorage.notepadSaveString ;
  console.log("document saved with saveString "+localStorage.notepadSaveString+"\n") ;
}

function loadDoc() {
  console.log("attempting to load document...") ;
  if (typeof localStorage.notepadContent !== "undefined" && localStorage.notepadContent !== "") {
    // If user has never been here or saved data is blank
    myTextarea.value = localStorage.notepadContent ;
    document.getElementById('title').innerHTML = "Loaded from " + localStorage.notepadSaveString ;
    console.log("document loaded from "+localStorage.notepadSaveString+"\n") ;
  } else {
    localStorage.notepadContent = "" ;
    localStorage.notepadSaveString = "" ;
    myTextarea.value = "Welcome to Austin Heiman's HTML5 localStorage notepad!\nNotes typed here will be auto-magically saved for next time!" ;
    myTextarea.select() ;
    console.log("document not found\n") ;
  }
}

</script>
<style>
body {
  margin:0px;
  background-color:#111;
}
textarea {
  resize:none;
  width:100%;
  height:100%;
  background-color:inherit;
  padding:15px;
  font-family: 'consolas' , monospace;
  font-size:1em;
  color:#eee;
  border:0px;
}
</style>
</head>
<body onload="loadDoc()">
<textarea id="myTextarea" autofocus onkeyup="saveDoc()" onmouseout="saveDoc()" onblur="saveDoc()" onload="var myTextarea = this ;"></textarea>
</body>
</html>
